var JLax = (function () {
	'use strict';

	function _toConsumableArray(a){return _arrayWithoutHoles(a)||_iterableToArray(a)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(a){if(Symbol.iterator in Object(a)||"[object Arguments]"===Object.prototype.toString.call(a))return Array.from(a)}function _arrayWithoutHoles(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _defineProperties(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c);}function _createClass(a,b,c){return b&&_defineProperties(a.prototype,b),c&&_defineProperties(a,c),a}var DEFAULT_OPTIONS={viewPort:document,className:"jlax",speed:1};var jlax=function(){function a(b){var c=this;_classCallCheck(this,a);var d=Object.assign({},DEFAULT_OPTIONS,b);d.viewPort===document&&(d.viewPort=window),this._viewPort=d.viewPort,this._viewPortHeight=null,this._className=d.className,this._speed=d.speed,this._items=[],this._scrollHandler=function(){requestAnimationFrame(c._render.bind(c));},this._loadHandler=function(a){a.target.removeEventListener("load",c._loadHandler),c._initaliseItem(c._items.find(function(b){return b.image===a.target}));};}return _createClass(a,[{key:"_initaliseItem",value:function i(a){var b=a.element,c=a.image,d=b.clientWidth,e=b.clientHeight;a.coverHeight=Math.max(this._viewPortHeight,e)*this._speed;var f=d/a.coverHeight,g=c.width/c.height;b.style.backgroundSize=f>g?"cover":"auto ".concat(a.coverHeight,"px");var h=b.offsetTop;a.scrollEntry=h-this._viewPortHeight,a.scrollExit=h+b.clientHeight,a.ready=!0,requestAnimationFrame(this._render.bind(this));}},{key:"_getViewPortScroll",value:function b(){var a=this._viewPort;if(a===window){var c=document.documentElement;return (window.pageYOffset||c.scrollTop)-(c.clientTop||0)}return a.scrollTop}},{key:"_render",value:function c(){var a=this._getViewPortScroll(),b=this._viewPortHeight;this._items.forEach(function(c){if(!(!c.ready||c.scrollEntry>=a||c.scrollExit<=a)){var d=c.element.clientHeight/2,e=c.element.offsetTop+d,f=b+c.element.clientHeight,g=(f-(e-(a-d)))/f,h=c.coverHeight-b,i=f*g-c.coverHeight;c.element.style.backgroundPositionY="".concat(i+h*g,"px");}});}},{key:"initalise",value:function c(){var a=this._viewPort;a.addEventListener("scroll",this._scrollHandler),a===window?this._viewPortHeight=window.innerHeight:(this._viewPortHeight=a.clientHeight,a.style.overflowY="scroll",a.style.position="relative");var b=this._loadHandler;this._items=_toConsumableArray(document.getElementsByClassName(this._className)).map(function(a){var c=getComputedStyle(a).backgroundImage,d=new Image;return d.src=c.replace(/url\(['"]?(.*?)['"]?\)/,"$1"),d.addEventListener("load",b),{element:a,ready:!1,image:d,coverHeight:null}});}},{key:"deinitialise",value:function b(){var a=this._viewPort;a!==window&&(a.style.position="",a.style.overflowY=""),this._viewPort.removeEventListener("scroll",this._scrollHandler),this._items.forEach(function(a){a.element.style.backgroundSize="",a.element.style.backgroundPositionY="";}),this._items=[];}}]),a}();

	return jlax;

}());
//# sourceMappingURL=jlax.js.map
